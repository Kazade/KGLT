CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
PROJECT(kglt)

# Set a default build type if none was specified
IF(NOT CMAKE_BUILD_TYPE AND NOT CMAKE_CONFIGURATION_TYPES)
  MESSAGE(STATUS "Setting CMAKE_BUILD_TYPE to 'Debug' by default. Use -DCMAKE_BUILD_TYPE=Release for a release build.")
  SET(CMAKE_BUILD_TYPE Debug CACHE STRING "Choose the type of build." FORCE)
  # Set the possible values of build type for cmake-gui
  SET_PROPERTY(CACHE CMAKE_BUILD_TYPE PROPERTY STRINGS "Debug" "Release" "MinSizeRel" "RelWithDebInfo")
ENDIF()


# Set module options
OPTION(KGLT_BUILD_TESTS "Build KGLT tests" ON)
OPTION(KGLT_BUILD_SAMPLES "Build KGLT samples" ON)
OPTION(KGLT_GL_VERSION_1X "Enable GL 1.x support" OFF)

IF(KGLT_GL_VERSION_1X)
ADD_DEFINITIONS(-DKGLT_GL_VERSION_1X)
ELSE()
SET(KGLT_GL_VERSION_2X "1")
ADD_DEFINITIONS(-DKGLT_GL_VERSION_2X)
ENDIF()

SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_SOURCE_DIR}/cmake_modules/")

FIND_PACKAGE(PkgConfig REQUIRED)
FIND_PACKAGE(OpenAL REQUIRED)
FIND_PACKAGE(TinyXML REQUIRED)
find_package(ZLIB REQUIRED)

ADD_DEFINITIONS("-Wall")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++1y -pthread")

PKG_CHECK_MODULES(SDL2 sdl2 REQUIRED)
PKG_CHECK_MODULES(GL gl REQUIRED)

FILE(COPY ${CMAKE_CURRENT_SOURCE_DIR}/kglt/materials DESTINATION ${CMAKE_BINARY_DIR}/kglt)
FILE(COPY ${CMAKE_CURRENT_SOURCE_DIR}/kglt/fonts DESTINATION ${CMAKE_BINARY_DIR}/kglt)

#FILE(GLOB_RECURSE QU3E ${CMAKE_SOURCE_DIR}/deps/qu3e/src/*.cpp)
#FILE(GLOB_RECURSE KAZMATH ${CMAKE_SOURCE_DIR}/deps/kazmath/kazmath/*c)

SET(DEPS_SOURCES
#    ${CMAKE_SOURCE_DIR}/deps/kaztimer/kaztimer.cpp
#    ${CMAKE_SOURCE_DIR}/deps/kazlog/kazlog/kazlog.cpp
#    ${CMAKE_SOURCE_DIR}/deps/jsonic/jsonic/jsonic.cpp
#    ${CMAKE_SOURCE_DIR}/deps/kfs/kfs/kfs.cpp
    ${CMAKE_SOURCE_DIR}/deps/SOIL/SOIL.c
    ${CMAKE_SOURCE_DIR}/deps/SOIL/image_DXT.c
    ${CMAKE_SOURCE_DIR}/deps/SOIL/image_helper.c
    ${CMAKE_SOURCE_DIR}/deps/SOIL/stb_image_aug.c
#    ${CMAKE_SOURCE_DIR}/deps/nuklear/nuklear.cpp
#    ${QU3E}
#    ${KAZMATH}
)

INCLUDE_DIRECTORIES(
    ${SDL2_INCLUDE_DIRS}
    ${GL_INCLUDE_DIRS}
    ${OPENAL_INCLUDE_DIRS}
    ${TinyXML_INCLUDE_DIR}
    ${ZLIB_INCLUDE_DIRS}
)

LINK_LIBRARIES(
    ${SDL2_LIBRARIES}
    ${GL_LIBRARIES}
    ${OPENAL_LIBRARY}
    ${TinyXML_LIBRARIES}
    ${ZLIB_LIBRARIES}
    rt
)

ADD_SUBDIRECTORY(kglt)
ADD_SUBDIRECTORY(tests)

IF(KGLT_BUILD_SAMPLES)
    ADD_SUBDIRECTORY(samples)
ENDIF(KGLT_BUILD_SAMPLES)
