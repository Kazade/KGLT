CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
PROJECT(kglt)

SET (CMAKE_C_COMPILER             "/usr/bin/clang")
SET (CMAKE_CXX_COMPILER             "/usr/bin/clang++")

SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake_modules/")
FIND_PACKAGE(PkgConfig)
FIND_PACKAGE(KAZMATH REQUIRED)

ADD_DEFINITIONS("-Wall -g")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x")
ADD_DEFINITIONS("-DBOOST_NO_RVALUE_REFERENCES") #https://svn.boost.org/trac/boost/ticket/4521

PKG_CHECK_MODULES(SDL sdl)
PKG_CHECK_MODULES(GL gl)
PKG_CHECK_MODULES(SIGC sigc++-2.0)

FIND_PACKAGE(Boost COMPONENTS system filesystem date_time REQUIRED)
FIND_PACKAGE(Freetype REQUIRED)

FILE(COPY ${CMAKE_SOURCE_DIR}/kglt/materials DESTINATION ${CMAKE_BINARY_DIR}/kglt)

INCLUDE_DIRECTORIES(
    ${CMAKE_SOURCE_DIR}
    ${KAZMATH_INCLUDE_DIRS}
    ${SDL_INCLUDE_DIRS}
    ${GL_INCLUDE_DIRS}
    ${GLU_INCLUDE_DIRS}
    ${SIGC_INCLUDE_DIRS}
    ${FREETYPE_INCLUDE_DIRS}
)

LINK_LIBRARIES(
    ${SDL_LIBRARIES}
    ${GL_LIBRARIES}
    ${GLU_LIBRARIES}
    ${SIGC_LIBRARIES}
    ${KAZMATH_LIBRARIES}
    ${Boost_FILESYSTEM_LIBRARY}
    ${Boost_SYSTEM_LIBRARY}
    ${Boost_DATE_TIME_LIBRARY}
    ${FREETYPE_LIBRARY}
)

ADD_SUBDIRECTORY(kglt)
ADD_SUBDIRECTORY(samples)

ENABLE_TESTING()

PKG_CHECK_MODULES(UNITTEST unittest++)
INCLUDE_DIRECTORIES(
    ${UNITTEST_INCLUDE_DIRS}
)

LINK_LIBRARIES(
    ${UNITTEST_LIBRARIES}
    kglt
)

IF(UNITTEST_FOUND)
    ADD_SUBDIRECTORY(tests)
ENDIF(UNITTEST_FOUND)



