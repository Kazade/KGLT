This is code that once existed in KGLT, and hopefully will once again, but it needs updating
to the latest APIs.
